category=document.getElementById("wb_barcode_form_category");changeObjectOffers(category);addProperty=document.getElementById("wb_barcode_form_addProperty");if(addProperty){addProperty.addEventListener("click",addPropertyPrototype)}addCustom=document.getElementById("wb_barcode_form_addCustom");if(addCustom){addCustom.addEventListener("click",addCustomPrototype)}$blockCollection=document.getElementById("collectionProperty");$blockCollection.querySelector(".del-item-custom").addEventListener("click",function(){this.closest(".item-collection-custom").remove();index=addCustom.dataset.index*1;addCustom.dataset.index=(index-1).toString()});$blockCollection.querySelector(".del-item-property").addEventListener("click",function(){this.closest(".item-collection-property").remove();index=addProperty.dataset.index*1;addProperty.dataset.index=(index-1).toString()});function addCustomPrototype(){let $blockCollection=document.getElementById("collectionProperty");let $addButtonCustom=this;let newForm=$addButtonCustom.dataset.prototype;let index=$addButtonCustom.dataset.index*1;newForm=newForm.replace(/__custom__/g,index);let div=document.createElement("div");div.classList.add("item-collection-custom");div.classList.add("w-100");div.innerHTML=newForm;$blockCollection.append(div);div.querySelector(".del-item-custom").addEventListener("click",function(){this.closest(".item-collection-custom").remove();index=$addButtonCustom.dataset.index*1;$addButtonCustom.dataset.index=(index-1).toString()});div.querySelector("#wb_barcode_form_custom_"+index+"_sort").value=index+1;$addButtonCustom.dataset.index=(index+1).toString()}function addPropertyPrototype(){let $blockCollection=document.getElementById("collectionProperty");let $addButtonProperty=this;let newForm=$addButtonProperty.dataset.prototype;let index=$addButtonProperty.dataset.index*1;newForm=newForm.replace(/__property__/g,index);let div=document.createElement("div");div.classList.add("item-collection-property");div.classList.add("w-100");div.innerHTML=newForm;$blockCollection.append(div);div.querySelector(".del-item-property").addEventListener("click",function(){this.closest(".item-collection-property").remove();index=$addButtonProperty.dataset.index*1;$addButtonProperty.dataset.index=(index-1).toString()});div.querySelector("#wb_barcode_form_property_"+index+"_sort").value=index+1;let $offer=div.querySelector("#wb_barcode_form_property_"+index+"_offer");$prototypeOffer=document.getElementById("wb_barcode_form_offer_prototype");Array.from($prototypeOffer.children).forEach(option=>{$offer.appendChild(option.cloneNode(true))});$addButtonProperty.dataset.index=(index+1).toString();div.querySelectorAll('[data-select="select2"]').forEach(function(item){new NiceSelect(item,{searchable:true})})}function changeObjectOffers(category,index=0){category.addEventListener("change",function(){let replaceId="wb_barcode_form_offer_prototype";let replaceElement=document.getElementById(replaceId+"_select2");if(replaceElement){replaceElement.classList.add("disabled")}const requestModalName=new XMLHttpRequest;requestModalName.responseType="document";let incomingForm=document.forms.wb_barcode_form;let formData=new FormData;let categoryName=document.getElementById("wb_barcode_form_category");formData.append(categoryName.getAttribute("name"),this.value);requestModalName.open(incomingForm.getAttribute("method"),incomingForm.getAttribute("action"),true);requestModalName.addEventListener("readystatechange",function(){if(requestModalName.readyState===4&&requestModalName.status===200){let result=requestModalName.response.getElementById("wb_barcode_form_offer_prototype");document.getElementById(replaceId).replaceWith(result);let addProperty=document.getElementById("wb_barcode_form_addProperty");addProperty.dataset.index="0";addProperty.disabled=result.disabled;document.getElementById("collectionProperty").innerHTML=""}return false});requestModalName.send(formData)})}